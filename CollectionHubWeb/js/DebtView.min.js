function selectRow(a,b,c){$("#selectedDebtId").val(a),progressInterval=20,progressValue=0,refreshRecoveryCycles(a),refreshPaymentHistory(a,b,c),refreshParties(a),refreshDebtAttributes(a),refreshArrangements(a)}function loadDebtsView(a){a.hasOwnProperty("d")&&(a=a.d);var b=$("#dataTableMain").dataTable({destroy:!0,bSort:!1,order:[[2,"desc"]],aaData:a,scrollY:"250px",scrollCollapse:!0,paging:!1,bFilter:!1,aoColumns:[{mData:"DebtId"},{mData:"DebtSource"},{mData:"DebtAccRef"},{mData:"DebtReference"},{mData:"DebtTotal"},{mData:"DebtOutstanding"},{mData:"RecoveryCycle"},{mData:"Status"},{mData:"Type"},{mData:"GroupOrder"}],aoColumnDefs:[{sTitle:"Initial Debt",aTargets:["debt_initial"],sClass:"right",mRender:function(a){return formatCurrency(a)}},{sTitle:"O/S Debt",aTargets:["debt_outstanding"],sClass:"right",mRender:function(a){return formatCurrency(a)}},{sTitle:"Debt ID",aTargets:["debt_id"],mRender:function(a){return'<a href="#" onclick="selectRow('+a+')">'+a+"</a>"}},{sTitle:'<input id="debtGroupAll" type="checkbox" class="debtGroupAll">',bSortable:!1,bSearchable:!1,aTargets:["select_id"],mRender:function(a,b,c){return'<input type="checkbox" class="debtGroupItems" debtGroupDebtId="'+a+'" debtRowTotal="'+c.DebtTotal+'">'}},{aTargets:["group_order"],bVisible:!1},{width:"10px",targets:0}],initComplete:function(a){for(var c=[],d=[],e=0;e<a.aoData.length;e++)a.aoData[e].anCells[9].outerText.length>0&&(c.push(a.aoData[e].anCells[9].outerText+"-"+e),d.push(a.aoData[e].anCells[9].outerText));for(var f=0;f<d.length;f++){for(var g=9999,h=0,i=0;i<c.length;i++)c[i].split("-")[0]==d[f]&&(c[i].split("-")[1]<g&&(g=parseInt(c[i].split("-")[1])+1),c[i].split("-")[1]>h&&(h=parseInt(c[i].split("-")[1])+1));g=g++,h=h++,console.log("min:'"+g+"', max:'"+h+"'"),$("#dataTableMain tr:nth-child("+g+")").addClass("groupTop"),$("#dataTableMain tr:nth-child("+h+")").addClass("groupBottom")}$("#debtGroupAll").click(function(){$(".debtGroupItems").prop("checked",$(this).prop("checked"))}),$("#dataTableMain tbody").on("click","tr",function(a){var c=$(a.currentTarget.cells[0]),d=c.find("input:checkbox");$("#debtRowTotalValue").val(d.attr("debtRowTotal")),"undefined"!=$("#agmTotalDebtAmount")&&($("#agmTotalDebtAmount").val(d.attr("debtRowTotal")),$("#agmAgreedAmount").val(d.attr("debtRowTotal"))),selectRow(d.attr("debtGroupDebtId"),a.currentTarget.cells[1].innerHTML.trim(),a.currentTarget.cells[2].innerHTML.trim()),b.$("tr.selected").removeClass("active"),$(this).hasClass("active")?$(this).removeClass("active"):(b.$("tr.active").removeClass("active"),$(this).addClass("active"))})}})}function loadAttributesList(){$("#debtAttributes").val(""),$.ajax({type:"POST",url:"DataService.aspx/GetAttributeList",data:"{'listDebtAttributes':'true','listPersonAttributes':'true'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){b.IsDebtAttribute&&$("#debtAttributes").append($("<option>",{value:b.AttributeId,text:b.AttributeText})),b.IsPersonAttribute&&$("#personAttributes").append($("<option>",{value:b.AttributeId,text:b.AttributeText}))})}})}function loadAttributeStatusTypes(){$("#attributeCurrentStatuses").val(""),$("#attributeCurrentStatuses").append($("<option>",{value:0,text:"Unknown"})),$.ajax({type:"POST",url:"DataService.aspx/GetAttributesCurrentStatuses",data:"{}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){$("#attributeCurrentStatuses").append($("<option>",{value:b.AttributeTypeId,text:b.TypeName}))})}})}function loadRecoveryCycleList(a){$.ajax({type:"POST",url:"DataService.aspx/GetTreatmentCycles",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){$("#recoveryCycles").append($("<option>",{value:b.TreatmentCycleId,text:b.TreatmentCycleName}))})}})}function loadArrangementFrequenciesList(){$("#agmFrequency").val(""),$.ajax({type:"POST",url:"DataService.aspx/GetFrequencyList",data:"{}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){console.log(b.ArrangementName),$("#agmFrequency").append($("<option>",{value:b.ArrangementCode,text:b.ArrangementName}))})}})}function loadArrangementPaymentMethodList(){$("#agmPaymentMethod").val(""),$.ajax({type:"POST",url:"DataService.aspx/GetPaymenyMethodList",data:"{}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){$("#agmPaymentMethod").append($("<option>",{value:b.PaymentMethodCode,text:b.PaymentMethodName}))})}})}function refreshDebtsList(){var a="false";2==$("#showCleared").val()&&(a="true"),$.ajax({type:"POST",url:"DataService.aspx/GetDebts",data:"{'pin':'"+$("#cnpin").val()+"', 'showCleared':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){loadDebtsView(a)}})}function refreshSingleDebtView(){var a="true";2==$("#showCleared").val()&&(a="true"),$.ajax({type:"POST",url:"DataService.aspx/GetDebts",data:"{'pin':'"+$("#cnpin").val()+"', 'showCleared':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){var b=$("#cnpin").val(),c=$("#uprn").val();loadDebtsView(a),refreshPersonOverview(b,c)}})}function refreshPersonOverview(a,b){progressInterval=100/7,progressValue=0,refreshPersonAttributes(a),refreshCurrentAttributes(a),refresMatchList(a),refresMisMisMatchList(a),refreshPersonDetails(a,b),refreshPaymentHistoryByPin(a),refreshPartiesByPin(a),refreshArrangementsByPin(a)}function refreshRecoveryCycles(a){$.ajax({type:"POST",url:"DataService.aspx/GetRecoveryCycleHistory",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefRecovery"),a.hasOwnProperty("d")&&(a=a.d),$("#tableRecovery").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"ActionText"},{mData:"Action"},{mData:"ActionStatus"},{mData:"ProcessMethod"},{mData:"ActionGroup"},{mData:"Actionable"},{mData:"ColumnFormat"},{mData:"Scheduled"},{mData:"ID"},{mData:"DebtID"},{mData:"DebtReference"}],aoColumnDefs:[{aTargets:["id"],bVisible:!1},{aTargets:["debtId"],bVisible:!1},{aTargets:["debtReference"],bVisible:!1},{aTargets:["actionGroup"],bVisible:!1},{aTargets:["columnFormat"],bVisible:!1},{sTitle:"Scheduled",aTargets:["scheduled"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}}],initComplete:function(a){for(var b=0;b<a.aoData.length;b++)"bold"==a.aoData[b].anCells[6].outerText.toLowerCase()&&$("#tableRecovery tr:eq("+b+")").css("font-weight","bold")}})}})}function refreshPaymentHistoryByPin(a){$.ajax({type:"POST",url:"DataService.aspx/GetPaymentsByPin",data:"{'pin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefPayments"),a.hasOwnProperty("d")&&(a=a.d),$("#tablePayments").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"PaymentId"},{mData:"PaymentSource"},{mData:"PaymentSourceAccountReference"},{mData:"PaymentDebtReference"},{mData:"PaymentAmount"},{mData:"PaymentDate"}],aoColumnDefs:[{sTitle:"Amount",aTargets:["payment_amount"],sClass:"right",mRender:function(a){return formatCurrency(a)}},{sTitle:"Payment Date",sClass:"right",aTargets:["payment_date"],mRender:function(a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}}]})}})}function refreshPaymentHistory(a,b,c){$.ajax({type:"POST",url:"DataService.aspx/GetPaymentsByDebtId",data:"{'debtId':'"+a+"','source':'"+b+"','sourceAccountReference':'"+c+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefPayments"),a.hasOwnProperty("d")&&(a=a.d),$("#tablePayments").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"PaymentId"},{mData:"PaymentSource"},{mData:"PaymentSourceAccountReference"},{mData:"PaymentDebtReference"},{mData:"PaymentAmount"},{mData:"PaymentDate"}],aoColumnDefs:[{sTitle:"Amount",aTargets:["payment_amount"],sClass:"right",mRender:function(a){return formatCurrency(a)}},{sTitle:"Payment Date",aTargets:["payment_date"],mRender:function(a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}}]})}})}function refreshParties(a){$.ajax({type:"POST",url:"DataService.aspx/GetPartiesByDebt",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefParties"),a.hasOwnProperty("d")&&(a=a.d),$("#tableParties").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"PartyFullName"},{mData:"PrimaryFlag"}]})}})}function refreshPartiesByPin(a){$.ajax({type:"POST",url:"DataService.aspx/GetPartiesByPin",data:"{'pin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefParties"),a.hasOwnProperty("d")&&(a=a.d),$("#tableParties").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"PartyFullName"},{mData:"PrimaryFlag"}]})}})}function refreshArrangements(a){$.ajax({type:"POST",url:"DataService.aspx/GetArrangements",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefArrangements"),a.hasOwnProperty("d")&&(a=a.d),$("#tableArrangements").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"CreatedDate"},{mData:"AggreedAmount"},{mData:"Frequency"},{mData:"FrequencyDescription"},{mData:"InstallmentAmount"},{mData:"NumberOfInstallments"},{mData:"AgmStatus"}]})}})}function refreshArrangementsByPin(a){$.ajax({type:"POST",url:"DataService.aspx/GetArrangementsByPin",data:"{'pin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefArrangements"),a.hasOwnProperty("d")&&(a=a.d),$("#tableArrangements").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"CreatedDate"},{mData:"AggreedAmount"},{mData:"Frequency"},{mData:"FrequencyDescription"},{mData:"InstallmentAmount"},{mData:"NumberOfInstallments"},{mData:"AgmStatus"}]})}})}function refreshDebtAttributes(a){$.ajax({type:"POST",url:"DataService.aspx/GetDebtAttribute",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefDebtAttributes"),a.hasOwnProperty("d")&&(a=a.d),$("#tableDebt").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"AttributeText"},{mData:"AttributeValue"}],columnDefs:[{width:"200px",targets:0},{width:"*%",targets:1}]})}})}function refreshPersonAttributes(a){$.ajax({type:"POST",url:"DataService.aspx/GetPersonAttribute",data:"{'sourcePin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefPersonAttributes"),a.hasOwnProperty("d")&&(a=a.d),$("#tablePerson").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"AttributeText"},{mData:"AttributeValue"},{mData:"Streams"},{mData:"ToDate"},{mData:"FromDate"},{mData:"StatusText"},{mData:"PersonAttributeId"}],aoColumnDefs:[{sTitle:"From Date",aTargets:["from_date"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{sTitle:"To Date",aTargets:["to_date"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{sTitle:"Current Attribute",aTargets:["set_current"],mRender:function(a,b,c){return'<a href="#" onclick="doSelect($(this),'+c.PersonAttributeId+')">'+a+"</a>"}},{aTargets:["person_attribute_id"],bVisible:!1},{width:"200px",targets:0},{width:"*%",targets:1},{width:"130px",targets:2},{width:"110px",targets:3},{width:"100px",targets:4},{width:"130px",targets:5}]})}})}function refreshCurrentAttributes(a){$.ajax({type:"POST",url:"DataService.aspx/GetCurrentAttribute",data:"{'partyPin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefCurrentAttributes"),a.hasOwnProperty("d")&&(a=a.d),$("#tableCurrent").dataTable({destroy:!0,aaData:a,aoColumns:[{mData:"AttributeText"},{mData:"AttributeValue"}],aoColumnDefs:[{width:"200px",targets:0},{width:"*%",targets:1}]})}})}function refreshPersonDetails(a,b){$.ajax({type:"POST",url:"DataService.aspx/GetPersonDetails",data:"{'pin':'"+a+"','uprn':'"+b+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){a.hasOwnProperty("d")&&(a=a.d),$("#dataTablePersonDetails").dataTable({destroy:!0,aaData:a,scrollCollapse:!0,paging:!1,bFilter:!1,bInfo:!1,aoColumns:[{mData:"AccountRef"},{mData:"FULLNAME"},{mData:"FULLADDRESS"},{mData:"NINO"},{mData:"DOB"}],aoColumnDefs:[{sTitle:"To Date",aTargets:["DOB"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{width:"175px",targets:0},{width:"250px",targets:1},{width:"175px",targets:3},{width:"80px",targets:4}]})}})}function refresMatchList(a){$.ajax({type:"POST",url:"DataService.aspx/GetMatchListByPin",data:"{'pin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefMatches"),a.hasOwnProperty("d")&&(a=a.d),$("#matchTable1").dataTable({destroy:!0,aaData:a,bSort:!1,paging:!1,bFilter:!1,bInfo:!1,aoColumns:[{mData:"InfoString"},{mData:"SourceName"},{mData:"SourceAccRef"},{mData:"FullName"},{mData:"FullAddress"},{mData:"NINO"},{mData:"DOB"},{mData:"MatchId"}],aoColumnDefs:[{sTitle:"DOB",aTargets:["dob"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{sTitle:"Action",aTargets:["MatchId"],mRender:function(a){return'<a href="#" onclick="unlinkMatchedResult('+a+');">Unlink</a>'}},{sTitle:"",aTargets:["infoHover"],mRender:function(a,b,c){return'<div title="'+c.InfoString+'"><i class="fa fa-info-circle"></i></div>'}},{width:"10px",targets:0},{width:"50px",targets:1},{width:"80px",targets:2},{width:"250px",targets:3},{width:"*%",targets:4},{width:"80px",targets:5},{width:"80px",targets:6},{width:"80px",targets:7}]})}})}function refresMisMisMatchList(a){$.ajax({type:"POST",url:"DataService.aspx/GetMisMatchListByPin",data:"{'pin':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){doProgress(a.d.length,"arefMisMatches"),a.hasOwnProperty("d")&&(a=a.d),$("#matchTable2").dataTable({destroy:!0,aaData:a,bSort:!1,bFilter:!1,paging:!1,bInfo:!1,aoColumns:[{mData:"InfoString"},{mData:"SourceName"},{mData:"SourceAccRef"},{mData:"FullName"},{mData:"FullAddress"},{mData:"NINO"},{mData:"DOB"},{mData:"MatchId"}],aoColumnDefs:[{sTitle:"Action",aTargets:["MatchId"],mRender:function(a,b,c){return'<a href="#" onclick="linkMatchedResult('+c.MatchId+');">Link</a>'}},{sTitle:"",aTargets:["infoHover"],mRender:function(a,b,c){return'<div title="'+c.InfoString+'"><i class="fa fa-info-circle"></i></div>'}},{width:"10px",targets:0},{width:"50px",targets:1},{width:"80px",targets:2},{width:"250px",targets:3},{width:"*%",targets:4},{width:"80px",targets:5},{width:"80px",targets:6},{width:"80px",targets:7}]})}})}function refreshDebtActionTabs(a){var b='class="active"',c="";$.ajax({type:"POST",async:!1,url:"DataService.aspx/GetTreatmentGroups",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(d){d.hasOwnProperty("d")&&(d=d.d),$.each(d,function(d,e){c=c+"<li "+b+'> <a href="#debtRecoveryTab_'+e+'" data-toggle="tab">'+e+"</a></li>";var f=!1;b.length>0&&(f=!0),refreshDebtActionItems(f,e,a),b=""}),$("#debtActionTabMenu").append('<ul class="nav nav-tabs">'+c+"</ul>");var e=$("#debtActionTabPanels").html();$("#debtActionTabPanels").html('<div class="tab-content">'+e+"</div>")}})}function refreshDebtActionItems(a,b,c){var d="";$.ajax({type:"POST",async:!1,url:"DataService.aspx/GetTreatmentsForGroup",data:"{'actionType':'"+b+"','debtId':'"+c+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(c){c.hasOwnProperty("d")&&(c=c.d),$.each(c,function(a,b){d=d+'<p><a href="#" onclick="createAdHocDocument('+b.Id+');">'+b.Name+"</a></p>"}),$("#debtActionTabPanels").append(a?'<div class="tab-pane fade in active" id="debtRecoveryTab_'+b+'"><div style="padding-top:15px">'+d+"</div></div>":'<div class="tab-pane fade in" id="debtRecoveryTab_'+b+'"><div style="padding-top:15px">'+d+"</div></div>")}})}function linkMatchedResult(a){var b=$("#cnpin").val();$.ajax({type:"POST",url:"DataService.aspx/CreateMatch",data:"{'matchId':'"+a+"','pin':'"+b+"','userId':'"+$("#UserSessionToken").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){refresMatchList(b),refresMisMisMatchList(b)},failure:function(a){alert(a.message)}})}function unlinkMatchedResult(a){var b=$("#cnpin").val();$.ajax({type:"POST",url:"DataService.aspx/RemoveMatch",data:"{'matchId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){refresMatchList(b)},failure:function(a){alert(a.message)}})}function createDebtAttribute(){$.ajax({type:"POST",url:"DataService.aspx/CreateDebtAttribute",data:"{'debtId':'"+$("#selectedDebtId").val()+"','userId':'"+$("#UserSessionToken").val()+"','attributeId':'"+$("#debtAttributes").val()+"','isCurrent':'true','attributeValue':'"+$("#debtAttributesValue").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){1!=a.d?alert("error: CreateDebtAttribute returned FALSE"):($("#debtAttributesValue").val(""),refreshDebtAttributes($("#selectedDebtId").val())),$("#debtAttributeModal").modal("hide")},failure:function(a){alert(a),$("#debtAttributeModal").modal("hide")}})}function createPersonAttribute(){console.log("{'sourceRef':'"+$("#cnpin").val()+"','userId':'"+$("#UserSessionToken").val()+"','attributeId':'"+$("#personAttributes").val()+"','isCurrent':'true','attributeValue':'"+$("#personAttributesValue").val()+"'}"),$.ajax({type:"POST",url:"DataService.aspx/CreatePersonAttribute",data:"{'sourceRef':'"+$("#cnpin").val()+"','userId':'"+$("#UserSessionToken").val()+"','attributeId':'"+$("#personAttributes").val()+"','isCurrent':'true','attributeValue':'"+$("#personAttributesValue").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){1!=a.d?console.log("error: CreatePersonAttribute returned FALSE"):($("#personAttributesValue").val(""),refreshPersonAttributes($("#cnpin").val())),$("#personAttributeModal").modal("hide")},failure:function(a){console.log(a),$("#personAttributeModal").modal("hide")}})}function createRecoveryCycle(){console.log($("#recoveryStartDate").val()),$.ajax({type:"POST",url:"DataService.aspx/SetRecoveryCycle",data:"{'debtId':'"+$("#selectedDebtId").val()+"','recoveryCycleId':'"+$("#recoveryCycles").val()+"','userId':'"+$("#UserSessionToken").val()+"','recoveryDateTime':'"+$("#recoveryStartDate").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){1!=a.d?console.log("error: createRecoveryCycle returned FALSE"):($("#recoveryStartDate").val(""),$("#recoveryCycles").val(""),$("#createRecoveryCycleModal").modal("hide"),refreshRecoveryCycles($("#selectedDebtId").val())),$("#personAttributeModal").modal("hide")},failure:function(a){console.log(a.message),$("#debtAttributeModal").modal("hide")}})}function createDebtAction(a,b){$("#documentSelection").hide(),$("#loading").show(),$.ajax({type:"POST",url:"DocumentService.aspx/MergeDocument",data:"{'documentTemplateId':'"+a+"','templateId':'"+b+"','userId':'"+getUserId()+"','pin':'"+$("#cnpin").val()+"','uprn':'"+$("#uprn").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){CKEDITOR.instances.editDocumentContent.setData(b.d),$("#editDocumentContent").attr("templateItemId",a),$("#loading").hide(),$("#editor").show()},failure:function(a){alert(a)}}),$("#documentEdit").show()}function createAgreement(a,b,c,d,e,f,g,h,i,j,k,l,m,n){$.ajax({type:"POST",url:"DataService.aspx/CreateArrangement",data:"{'agm_pin':'"+$("#cnpin").val()+"', 'agm_cd_id':'"+$("#selectedDebtId").val()+"', 'agm_start_date':'"+a+"', 'agm_frequency':'"+b+"', 'agm_day_of_month':'"+c+"', 'agm_day_of_week':'"+d+"', 'agm_start_amount':'"+e+"', 'agm_installment_amount':'"+f+"', 'agm_number_installment':'"+g+"', 'agm_payment_method':'"+h+"', 'agm_agreed_amount':'"+i+"', 'agm_totaldebt_amount':'"+j+"', 'agm_last_amount':'"+k+"', 'agm_Created_By':'"+getUserId()+"', 'agm_agreement_date':'"+l+"', 'agm_payment_date':'"+m+"', 'agm_starting_from_date':'"+n+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){a.d&&alert("True")},failure:function(a){alert(a)}}),$("#tableArrangementsModal").modal("hide")}function setCurrent(a){$.ajax({type:"POST",url:"DataService.aspx/SetPersonAttributeCurrent",data:"{'personAttributeId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){refreshCurrentAttributes($("#cnpin").val()),refreshPersonAttributes($("#cnpin").val())},failure:function(a){alert(a.message)}})}function setTagIndicator(a,b){b="#"+b,result.length>0?$(b).css("font-weight","bold"):$(b).css("font-weight","normal")}function setAttributeStatus(a,b){$.ajax({type:"POST",url:"DataService.aspx/SetPersonAttributeStatus",data:"{'userId':'"+getUserId()+"','statusId':'"+b+"','personAttributeId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){refreshPersonAttributes($("#cnpin").val())},failure:function(a){alert(a.message)}})}function groupDebts(){var a="";$(".debtGroupItems:checked").each(function(){a=a+$(this).attr("debtGroupDebtId")+","}),console.log(a),$.ajax({type:"POST",url:"DataService.aspx/CreateDebtGroup",data:"{'debtIdString':'"+a+"','userId':'"+$("#UserSessionToken").val()+"','partyPin':'"+$("#cnpin").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){1!=a.d?alert("error: groupDebts returned FALSE"):refreshSingleDebtView()},failure:function(a){alert(a)}}),$("#myModal").modal("hide")}function ungroupDebts(){var a="";$(".debtGroupItems:checked").each(function(){a+=$(this).attr("debtGroupDebtId")}),console.log(a),$.ajax({type:"POST",url:"DataService.aspx/RemoveDebtGroup",data:"{'debtId':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){1!=a.d?alert("error: ungroupDebts returned FALSE"):refreshSingleDebtView()},failure:function(a){alert(a)}}),$("#ungroupDebtModal").modal("hide")}function doSelect(a,b){var c=$("#attributeCurrentStatuses").clone(),d=getUUID();c.attr("id",d),c.css("visibility",""),$(a).parent().html(c),$("#"+d).val(b),$("#"+d).change(function(){var a=$("#"+d).val(),c=b;setAttributeStatus(c,a)})}function createAdHocDocument(a){var b=$("#selectedDebtId").val();$("#debtActionModal").modal("hide"),console.log("{'debtId':'"+b+"','actionItemId':'"+a+"','userId':'"+getUserId()+"'}"),$.ajax({type:"POST",url:"DataService.aspx/CreateAdHocItem",data:"{'debtId':'"+b+"','actionItemId':'"+a+"','userId':'"+getUserId()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){refreshRecoveryCycles(b)},failure:function(){}})}$("#showClearedLoadingImage").hide(),$("#pageBody_pageIcon").click(function(a){a.preventDefault(),refreshSingleDebtView()}),$("#pageIcon").click(function(a){a.preventDefault(),refreshSingleDebtView()}),$(function(){loadAttributeStatusTypes(),refreshSingleDebtView()});