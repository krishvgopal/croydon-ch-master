function doSearch(){$("#loadingImage").toggle(),$.ajax({type:"POST",url:"DataService.aspx/SearchDebts",data:"{'amountFrom':'"+$("#amountFrom").val()+"', 'amountTo':'"+$("#amountTo").val()+"', 'debtStreamCount':'"+$("#debtStreamCount").val()+"', 'includesStreamCode':'"+$("#debtStreamCode").val()+"', 'lastPaymentCode':'"+$("#lastPayment").val()+"', 'debtAgeCode':'"+$("#debtAge").val()+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){a.hasOwnProperty("d")&&(a=a.d),$("#searchTable").dataTable({destroy:!0,aaData:a.Results,aoColumns:[{mData:"FullName"},{mData:"FullAddress"},{mData:"DebtStream"},{mData:"NumberOfDebts"},{mData:"TotalAmount"},{mData:"LastPaid"},{mData:"LatestDebt"},{mData:"Source"},{mData:"CnPin"}],aoColumnDefs:[{aTargets:["full_name"],mRender:function(a,b,c){return'<a href="DebtView.aspx?cn_pin='+c.CnPin+"&uprn="+c.UrPin+'" target="_blank" ">'+c.FullName+"</a>"}},{aTargets:["source"],bVisible:!0},{aTargets:["cnpin"],bVisible:!1},{sTitle:"Last Paid",aTargets:["last_paid"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{sTitle:"Latest Debt",aTargets:["latest_debt"],mRender:function(a){if(null!=a){var b=new Date(parseInt(a.substr(6))),c=moment(b);return c.format("DD/MM/YYYY")}return""}},{width:"100",targets:2},{width:"100",targets:3}]}),$("#searchResults").show(),$("#loadingImage").toggle()}})}function loadStreams(){$.ajax({type:"POST",url:"DataService.aspx/GetDebtStreams",data:"{}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$.each(a.d,function(a,b){$("#debtStreamCode").append($("<option>",{value:b.Id,text:b.StreamName}))})}})}$("#loadingImage").hide(),$("#searchResults").hide(),$(":text").keypress(function(a){13==a.which&&doSearch()}),loadStreams();